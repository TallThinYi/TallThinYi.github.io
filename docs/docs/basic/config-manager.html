<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="joy-head-count" content="2"/><link rel="icon" href="data:image/ico;base64,aWNv"/><link rel="preload" href="/_joy/static/css/1a84feb618dc0ce5806b.css" as="style"/><link rel="stylesheet" href="/_joy/static/css/1a84feb618dc0ce5806b.css" data-n-g=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_joy/static/chunks/main-f5ad9e2f6a1848fb96a9.js" as="script"/><link rel="preload" href="/_joy/static/chunks/webpack-373fdeea3ec48be3183e.js" as="script"/><link rel="preload" href="/_joy/static/chunks/framework-91d62d687813a572f876.js" as="script"/><link rel="preload" href="/_joy/static/chunks/commons-b00d9a851efe857c40f3.js" as="script"/><link rel="preload" href="/_joy/static/chunks/pages/_app-90191bb1e1c9998796e2.js" as="script"/></head><body><div id="__joy"><section class="ant-layout"><link id="theme-style" rel="stylesheet" href="/static/antd.css"/><header class="layout_header__1OM0M"><nav id="nav" class="layout_nav__K3mbB"><div id="nav-inner" class="layout_nav__inner__2uMRU"><a id="logo" href="/" class="layout_logo__FKYzP"><img alt="logo" src="https://gw.alipayobjects.com/zos/rmsportal/KDpgvguMpGfqaHPjicRK.svg"/>Symph Joy</a><button id="collapseBtn" type="button" class="ant-btn ant-btn-text ant-btn-lg layout_menu__collapseBtn__FF_4T"><span role="img" aria-label="menu-unfold" class="anticon anticon-menu-unfold"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu-unfold" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"></path></svg></span></button><ul class="ant-menu-overflow ant-menu ant-menu-root ant-menu-horizontal ant-menu-light layout_menu__2a0TM layout_menu__collapsed__cIvBb" role="menu" tabindex="0" data-menu-list="true"><li class="ant-menu-overflow-item ant-menu-item ant-menu-item-only-child" style="opacity:1;order:0" role="menuitem" tabindex="-1"><span class="ant-menu-title-content"><a href="/docs">开始</a></span></li><li class="ant-menu-overflow-item ant-menu-item ant-menu-item-only-child" style="opacity:1;order:1" role="menuitem" tabindex="-1"><span class="ant-menu-title-content">配置</span></li><li class="ant-menu-overflow-item ant-menu-item ant-menu-item-only-child" style="opacity:1;order:2" role="menuitem" tabindex="-1"><span class="ant-menu-title-content">API</span></li><li class="ant-menu-overflow-item ant-menu-item ant-menu-item-only-child" style="opacity:1;order:3" role="menuitem" tabindex="-1"><span class="ant-menu-title-content">指南</span></li><li class="ant-menu-overflow-item ant-menu-item ant-menu-item-only-child" style="opacity:1;order:4" role="menuitem" tabindex="-1"><span class="ant-menu-title-content">插件</span></li><li class="ant-menu-overflow-item ant-menu-item ant-menu-item-only-child" style="opacity:1;order:5" role="menuitem" tabindex="-1"><span class="ant-menu-title-content"><a id="change-theme" class="layout_theme__switch__133kS"><span><span role="img" class="anticon"><svg viewBox="0 0 1024 1024" fill="currentColor" width="1em" height="1em"><path d="M512 832a64 64 0 0 1 64 64v64a64 64 0 1 1-128 0v-64a64 64 0 0 1 64-64z m0-640a64 64 0 0 1-64-64V64a64 64 0 1 1 128 0v64a64 64 0 0 1-64 64z m448 256a64 64 0 1 1 0 128h-64a64 64 0 1 1 0-128h64zM192 512a64 64 0 0 1-64 64H64a64 64 0 1 1 0-128h64a64 64 0 0 1 64 64z m636.768 226.272l45.248 45.248a64 64 0 1 1-90.496 90.496l-45.248-45.248a64 64 0 1 1 90.496-90.496zM195.232 285.728L149.984 240.48a64 64 0 1 1 90.496-90.496l45.248 45.248a64 64 0 1 1-90.496 90.496z m633.536 0a64 64 0 1 1-90.496-90.496l45.248-45.248a64 64 0 1 1 90.496 90.496l-45.248 45.248zM195.232 738.272a64 64 0 1 1 90.496 90.496l-45.248 45.248a64 64 0 1 1-90.496-90.496l45.248-45.248zM512 256a256 256 0 1 0 0 512 256 256 0 0 0 0-512z m0 416a160 160 0 1 1 0.032-320.032A160 160 0 0 1 512 672z" p-id="2605"></path></svg></span><span role="img" class="anticon"><svg viewBox="0 0 1024 1024" fill="currentColor" width="1em" height="1em"><path d="M514.56 938.666667h-40.106667a426.666667 426.666667 0 0 1 0-853.333334 42.666667 42.666667 0 0 1 42.666667 21.76A42.666667 42.666667 0 0 1 512 153.173333a256 256 0 0 0 358.4 358.4 42.666667 42.666667 0 0 1 46.08-2.986666 42.666667 42.666667 0 0 1 21.76 42.666666A426.666667 426.666667 0 0 1 514.56 938.666667zM397.226667 189.44a341.333333 341.333333 0 1 0 437.333333 437.333333A341.333333 341.333333 0 0 1 381.013333 356.266667a341.333333 341.333333 0 0 1 16.213334-166.826667z" p-id="3227"></path></svg></span></span></a></span></li><li class="ant-menu-overflow-item ant-menu-item ant-menu-item-only-child" style="opacity:1;order:6" role="menuitem" tabindex="-1"><span class="ant-menu-title-content"><div class="ant-select ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:200px"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">搜索</span></div></div></span></li><li class="ant-menu-overflow-item ant-menu-overflow-item-rest ant-menu-submenu ant-menu-submenu-horizontal" style="opacity:0;height:0;overflow-y:hidden;order:9007199254740991;pointer-events:none;position:absolute" aria-hidden="true" role="none"><div role="menuitem" class="ant-menu-submenu-title" tabindex="-1" aria-expanded="false" aria-haspopup="true"><span role="img" aria-label="ellipsis" class="anticon anticon-ellipsis"><svg viewBox="64 64 896 896" focusable="false" data-icon="ellipsis" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"></path></svg></span><i class="ant-menu-submenu-arrow"></i></div></li></ul><div style="display:none" aria-hidden="true"></div></div></nav></header><main class="ant-layout-content"><div class="ant-row ={styles.row" style="min-height:calc(100vh - 64px);position:relative"><div class="ant-col docs_menu__2p7Ft ant-col-sm-24 ant-col-md-5 ant-col-lg-5 ant-col-xl-4 ant-col-xxl-3"><div><div class=""><ul class="ant-menu ant-menu-root ant-menu-inline ant-menu-light docs_docMenus__3hgPX" style="height:calc(100vh - 73px)" role="menu" tabindex="0" data-menu-list="true"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="none"><div role="menuitem" style="padding-left:24px" class="ant-menu-submenu-title" tabindex="-1" aria-expanded="true" aria-haspopup="true"><span class="ant-menu-title-content">高级使用</span><i class="ant-menu-submenu-arrow"></i></div><ul class="ant-menu ant-menu-sub ant-menu-inline" data-menu-list="true"><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content">自定义 App</span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content">自定义 Document</span></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="none"><div role="menuitem" style="padding-left:24px" class="ant-menu-submenu-title" tabindex="-1" aria-expanded="true" aria-haspopup="true"><span class="ant-menu-title-content">基础使用</span><i class="ant-menu-submenu-arrow"></i></div><ul class="ant-menu ant-menu-sub ant-menu-inline" data-menu-list="true"><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content">快速开始</span></li><li role="none" class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open"><div role="menuitem" style="padding-left:48px" class="ant-menu-submenu-title" tabindex="-1" aria-expanded="true" aria-haspopup="true"><span class="ant-menu-title-content">配置</span><i class="ant-menu-submenu-arrow"></i></div><ul class="ant-menu ant-menu-sub ant-menu-inline" data-menu-list="true"><li role="menuitem" tabindex="-1" style="padding-left:72px" class="ant-menu-item ant-menu-item-selected ant-menu-item-only-child"><span class="ant-menu-title-content">配置</span></li><li role="menuitem" tabindex="-1" style="padding-left:72px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content">JOY 配置</span></li></ul></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content">应用目录</span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content">CSS 样式</span></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="none"><div role="menuitem" style="padding-left:24px" class="ant-menu-submenu-title" tabindex="-1" aria-expanded="true" aria-haspopup="true"><span class="ant-menu-title-content">start</span><i class="ant-menu-submenu-arrow"></i></div><ul class="ant-menu ant-menu-sub ant-menu-inline" data-menu-list="true"><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content">Hello Joy</span></li></ul></li></ul><div style="display:none" aria-hidden="true"></div></div></div></div><div class="docs_menuIcon__1G0AP"><span role="img" aria-label="menu-unfold" class="anticon anticon-menu-unfold"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu-unfold" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"></path></svg></span></div><div style="flex:1" class="ant-col"><div class="ant-spin-nested-loading"><div class="ant-spin-container"><div class="docs_docContent__3MuEv"><h1 id="配置">配置</h1>
<p>Joy 遵循约定大于配置原则，参考最佳实践约定默认配置，0 配置也可启动应用，即新应用无需配置文件也可立即运行和发布。</p>
<h2 id="配置文件">配置文件</h2>
<p>Joy 在<code>joy.config.ts</code>或者<code>config/config.ts</code>中配置项目，支持 ts、js、json、es6 文件格式。例如：</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// joy.config.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">basePath</span>: <span class="hljs-string">&quot;&quot;</span>,
  <span class="hljs-attr">apiPrefix</span>: <span class="hljs-string">&quot;/api&quot;</span>,
  <span class="hljs-attr">ssr</span>: <span class="hljs-literal">true</span>,
};
</code></pre>
<p>如果项目的配置不复杂，推荐在 <code>joy.config.ts</code> 中写配置; 如果项目的配置比较复杂，可以将配置写在 config/config.ts 中，并把配置的一部分拆分出去，加载配置时会自动合并到主配置中，例如路由配置可以拆分成单独的 routes.ts：</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// config/routes.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> [{ <span class="hljs-attr">exact</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-attr">component</span>: <span class="hljs-string">&quot;index&quot;</span> }];
</code></pre>
<p>等同于：</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// joy.config.ts</span>
{
  <span class="hljs-attr">apiPrefix</span>: <span class="hljs-string">&quot;/api&quot;</span>;
  <span class="hljs-attr">routes</span>: [{ <span class="hljs-attr">exact</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-attr">component</span>: <span class="hljs-string">&quot;index&quot;</span> }];
}
</code></pre>
<h2 id="多环境配置">多环境配置</h2>
<p>可以通过环境变量<code>NODE_ENV</code>或者<code>JOY_ENV</code>来区分不同环境配置，<code>JOY_ENV</code>的优先级更高。各环境配置文件，统一放在<code>/config</code>目录中，例如：<code>/config/config.beta.ts</code>、<code>/config/config.production.ts</code>。</p>
<p>各配置的加载顺序：<code>.env</code> ➡ <code>joy.config.ts</code> ➡ <code>config/config.ts</code> ➡ <code>config/config.production.ts</code> ， 后加载的配置会覆盖之前的配置。</p>
<h2 id="本地临时配置">本地临时配置</h2>
<p>可以新建 <code>config/config.local.ts</code>文件，例如该配置文件存在，则加载顺序为：
<code>.env</code> ➡ <code>joy.config.ts</code> ➡ <code>config/config.ts</code> ➡ <code>config/config.development.ts</code> ➡ <code>config/config.local.ts</code> 。</p>
<p><strong>注意：</strong></p>
<ul>
<li>该配置优先级最高，在最后加载该配置文件，且会覆盖之前读取的配置。</li>
<li><code>config.local.ts</code> 是本地开发调试的临时配置，请将其添加到 <code>.gitignore</code>，<strong>务必不要提交到 git 仓库中</strong></li>
</ul>
<h2 id="环境变量配置">环境变量配置</h2>
<h3 id="执行命令时添加环境变量">执行命令时添加环境变量</h3>
<p>例如：</p>
<pre><code class="hljs language-bash"><span class="hljs-comment"># OS X、 Linux</span>
$ port=3000 joy dev

<span class="hljs-comment"># Windows</span>
$ <span class="hljs-built_in">set</span> port=3000&amp;&amp;joy dev
</code></pre>
<p>如果要同时考虑 OS X 和 Windows，可借助三方工具 cross-env。</p>
<pre><code class="hljs language-bash">$ yarn add cross-env --dev
$ cross-env port=3000 umi dev
</code></pre>
<h3 id="env-配置文件">.env 配置文件</h3>
<p>Joy 约定根目录下的<code>.env</code>为环境变量配置文件，该配置文件将在初始化配置时加载，其配置的值于 <a href="#%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%97%B6%E6%B7%BB%E5%8A%A0%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">执行命令时添加环境变量</a></p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// .env</span>

port = <span class="hljs-number">3000</span>;
hostname = <span class="hljs-string">&quot;localhost&quot;</span>;
</code></pre>
<h2 id="应用内获取配置">应用内获取配置</h2>
<h3 id="通过-configservice-服务获取">通过 ConfigService 服务获取</h3>
<p><code>@symph/config</code>提供 <code>ConfigService</code>服务类，Joy 已内置该服务，通过其提供的<code>get&lt;T = any&gt;(configPath?:string, defaultValue?: T): T | undefined</code>方法获取配置值，方法参数：</p>
<ul>
<li>configPath: 配置键值，支持 object path，获取配置值对象的内部值。</li>
<li>defaultValue: 默认值，如果配置不存在，则返回默认值。</li>
</ul>
<p>例如有以下配置内容：</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// joy.config.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">database</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;mysql&quot;</span>,
    <span class="hljs-attr">host</span>: <span class="hljs-string">&quot;localhost&quot;</span>,
    <span class="hljs-attr">port</span>: <span class="hljs-number">3306</span>,
  },
};
</code></pre>
<p>在服务类中获取以上配置值：</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ConfigService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@symph/config&quot;</span>;

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@symph/core&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Value</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@symph/config&quot;</span>;

<span class="hljs-meta">@Component</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloService</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> configService: ConfigService</span>) {
    <span class="hljs-comment">// 通过 configKey 获取 配置</span>
    <span class="hljs-keyword">const</span> database = configService.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;database&quot;</span>);

    <span class="hljs-comment">// 如果配置值是一个对象，可以通过object path，获取获取对象内部属性的值</span>
    <span class="hljs-keyword">const</span> host = configService.<span class="hljs-property">get</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">&quot;database.host&quot;</span>, <span class="hljs-string">&quot;localhost&quot;</span>);
  }
}
</code></pre>
<h3 id="value-装饰器方式获取">@Value 装饰器方式获取</h3>
<p>在组件的属性上，通过<code>@Value(options)</code>装饰器申明需要自动注入配置，注入的属性键值默认为组件的属性名称，例如：</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@symph/core&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Value</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@symph/config&quot;</span>;

<span class="hljs-meta">@Component</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloService</span> {
  <span class="hljs-comment">// 读取joy.config.ts中配置的msg的值。</span>
  <span class="hljs-meta">@Value</span>()
  <span class="hljs-keyword">public</span> <span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span>;
}
</code></pre>
<p><code>@Value(options)</code> 定制参数列表：</p>
<ul>
<li><strong>configKey</strong> 类型<code>string</code>，默认等于被装饰的属性名称，指定注入是取的配置文件中的键值，由此属性名称和配置文件中的键值可以不相等。</li>
<li><strong>schema</strong> 类型<code>json-schema</code>，自定义 <a href="https://json-schema.org/learn/getting-started-step-by-step">json-schema</a> 定义属性规则，不推荐直接使用该属性，大部分情况下可使用<code>@tsed/schema</code>库提供的装饰器来申明校验规则，例如<code>@Max(3)</code>申明该配置的值不能大于 4，否则运行是抛出异常。</li>
</ul>
<ul>
<li><strong>transform</strong> 类型<code>(configValue: any) =&gt; any</code>, 注入值时被调用，入参为配置文件中的值，返回值为转换后的值，然后将转化后的值设置到属性上。</li>
</ul>
<blockquote>
<p><code>@Value()</code>声明的属性，也等于声明了一个配置项及其类型和验证规则，需要避免在不同地方声明相同的配置但又不兼容的类型，这种情况下，我们可以将声明移动到一个独立的配置类中，其它地方如果需要使用该配置，应该依赖和使用该类。</p>
</blockquote>
<h4 id="校验配置值">校验配置值</h4>
<p>使用<code>@tsed/schema</code>库提供的装饰器来申明校验规则。</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@symph/core&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Max</span>, <span class="hljs-title class_">MaxLength</span>, <span class="hljs-title class_">Required</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@tsed/schema&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Value</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@symph/config&quot;</span>;

<span class="hljs-meta">@Component</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BasicConfig</span> {
  <span class="hljs-comment">// 配置类型为number，且不能大于4，否则运行时抛出异常。</span>
  <span class="hljs-comment">// 如果未配置，默认为 2</span>
  <span class="hljs-meta">@Value</span>({ <span class="hljs-attr">default</span>: <span class="hljs-number">2</span> })
  <span class="hljs-meta">@Max</span>(<span class="hljs-number">4</span>)
  <span class="hljs-keyword">public</span> <span class="hljs-attr">workers</span>: <span class="hljs-built_in">number</span>;

  <span class="hljs-comment">// 必须配置，且长度不能大于64.</span>
  <span class="hljs-meta">@Value</span>()
  <span class="hljs-meta">@MaxLength</span>(<span class="hljs-number">64</span>)
  <span class="hljs-meta">@Required</span>()
  <span class="hljs-keyword">public</span> <span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-comment">// 配置是一个负责对象数组，类型和验证规则声明在对象的类上。</span>
  <span class="hljs-meta">@Value</span>()
  <span class="hljs-keyword">public</span> <span class="hljs-attr">routes</span>: <span class="hljs-title class_">Route</span>[];
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Route</span> {
  <span class="hljs-meta">@Required</span>()
  <span class="hljs-keyword">public</span> <span class="hljs-attr">path</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-keyword">public</span> <span class="hljs-attr">extract</span>: <span class="hljs-built_in">boolean</span>;
}
</code></pre>
</div></div></div></div><div class="ant-col ant-col-sm-24 ant-col-md-3 ant-col-lg-3 ant-col-xl-3 ant-col-xxl-3"><div><div class=""><div class="ant-anchor-wrapper docs_titleTree__24KFt" style="max-height:100vh"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#配置文件" title="配置文件">配置文件</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#多环境配置" title="多环境配置">多环境配置</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#本地临时配置" title="本地临时配置">本地临时配置</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#环境变量配置" title="环境变量配置">环境变量配置</a><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#执行命令时添加环境变量" title="执行命令时添加环境变量">执行命令时添加环境变量</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#.env-配置文件" title=".env 配置文件">.env 配置文件</a></div></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#应用内获取配置" title="应用内获取配置">应用内获取配置</a><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#通过-configservice-服务获取" title="通过 ConfigService 服务获取">通过 ConfigService 服务获取</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#@value-装饰器方式获取" title="@Value 装饰器方式获取">@Value 装饰器方式获取</a></div></div></div></div></div></div></div></div></main></section></div><script id="__JOY_DATA__" type="application/json">{"initState":{"noop":{},"reactAppInitManager":{"/docs/docs/basic/config-manager":{"initStatic":2,"init":0}},"layoutModel":{"theme":"light","collapsed":true,"isMobile":false},"docsModel":{"loadingCurrentDoc":false,"docMenus":[{"title":"高级使用","path":"/docs/advanced-features","children":[{"title":"自定义 App","path":"/docs/custom-app","hasMenu":false,"htmlContent":"\u003ch1 id=\"自定义-app\"\u003e自定义 App\u003c/h1\u003e\n\u003cp\u003eJoy 使用\u003ccode\u003eApp\u003c/code\u003e来包装和初始化整个界面，我们可以自定它来控制页面的初始化，例如：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e添加所有页面共有的布局。\u003c/li\u003e\n\u003cli\u003e捕获渲染错误，使用\u003ccode\u003ecomponentDidCatch\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e修改路由或者路由的渲染方式。\u003c/li\u003e\n\u003cli\u003e添加全局样式。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e我们开始覆盖默认的\u003ccode\u003eApp\u003c/code\u003e， 创建文件\u003ccode\u003e./src/pages/_app.tsx\u003c/code\u003e，修改其内容：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { IReactApplication, \u003cspan class=\"hljs-title class_\"\u003eReactRouter\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eRouteSwitch\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/react\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eReactAppProps\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/joy\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eApp\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title class_ inherited__\"\u003eReact.Component\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-title class_\"\u003eReactAppProps\u003c/span\u003e, \u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eprotected\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ereactRouter\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eReactRouter\u003c/span\u003e;\n  \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eprops: ReactAppProps, context?: \u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003esuper\u003c/span\u003e(props, context);\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e appContext = props.\u003cspan class=\"hljs-property\"\u003eappContext\u003c/span\u003e;\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ereactRouter\u003c/span\u003e = appContext.\u003cspan class=\"hljs-property\"\u003egetSync\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-title class_\"\u003eReactRouter\u003c/span\u003e\u0026gt;(\u003cspan class=\"hljs-string\"\u003e\u0026quot;reactRouter\u0026quot;\u003c/span\u003e);\n  }\n  \u003cspan class=\"hljs-title function_\"\u003erender\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e routes = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ereactRouter\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetRoutes\u003c/span\u003e() || [];\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eRouteSwitch\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eroutes\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{routes}\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eextraProps\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{{}}\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003c/span\u003e;\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eApp\u003c/code\u003e 的\u003ccode\u003eprops\u003c/code\u003e中包含了\u003ccode\u003eIReactApplication\u003c/code\u003e实例，我们可以通过它获取到整个 React 应用的业务组件，例如上面例子中的\u003ccode\u003ereactRouter\u003c/code\u003e路由组件。\n\u003ccode\u003erender()\u003c/code\u003e中使用的\u003ccode\u003eRouteSwitch\u003c/code\u003e组件来渲染应用中注册的路由，包括文件约定路由。\u003c/p\u003e\n\u003ch2 id=\"注意事项：\"\u003e注意事项：\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e如果你的应用正在开发模式下运行中，首次添加\u003ccode\u003e./src/pages/_app.js\u003c/code\u003e文件，需要重新启动开发服务器。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eApp\u003c/code\u003e在服务端和浏览器上都会被渲染，所以不能在这里使用\u003ccode\u003eNode.js\u003c/code\u003e特有的 API。\u003c/li\u003e\n\u003c/ul\u003e\n"},{"title":"自定义 Document","path":"/docs/custom-document","hasMenu":false,"htmlContent":"\u003ch1 id=\"自定义-document\"\u003e自定义 Document\u003c/h1\u003e\n\u003cp\u003e\u003ccode\u003eDocument\u003c/code\u003e React 组件用于生成页面的\u003ccode\u003e\u0026lt;html\u0026gt;\u003c/code\u003e和\u003ccode\u003e\u0026lt;body\u0026gt;\u003c/code\u003e标签， Joy 会根据应用内的组件和样式，自动生成必须的 js 和 css 标签，保证页面 html 能够正常被加载。\n我们可以通过自定义\u003ccode\u003eDocument\u003c/code\u003e在\u003ccode\u003e\u0026lt;html\u0026gt;\u003c/code\u003e加入自定义的扩展\u003ccode\u003e\u0026lt;head\u0026gt;\u003c/code\u003e、\u003ccode\u003e\u0026lt;link\u0026gt;\u003c/code\u003e或者\u003ccode\u003e\u0026lt;sciprt\u0026gt;\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e覆盖默认的\u003ccode\u003eDocument\u003c/code\u003e，创建文件\u003ccode\u003e./src/pages/_document.tsx\u003c/code\u003e并修改\u003ccode\u003eDocument\u003c/code\u003e如下：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDocument\u003c/span\u003e, { \u003cspan class=\"hljs-title class_\"\u003eHtml\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eHead\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eMain\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eJoyScript\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eDocumentContext\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/joy/document\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMyDocument\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title class_ inherited__\"\u003eDocument\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-built_in\"\u003eany\u003c/span\u003e\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetInitialProps\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003ectx: DocumentContext\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e initialProps = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetInitialProps\u003c/span\u003e(ctx);\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e { ...initialProps };\n  }\n\n  \u003cspan class=\"hljs-title function_\"\u003erender\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\n      \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eHtml\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eHead\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eHead\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eMain\u003c/span\u003e /\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eJoyScript\u003c/span\u003e /\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eHtml\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    );\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e上面示例中的\u003ccode\u003eMyDocument\u003c/code\u003e，等效于 Joy 默认的\u003ccode\u003eDocument\u003c/code\u003e，未加入自定义的内容，如果不需要\u003ccode\u003egetInitialProps\u003c/code\u003e或者\u003ccode\u003erender\u003c/code\u003e方法，可以删除掉。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode\u003eHtml\u003c/code\u003e、\u003ccode\u003eHead\u003c/code\u003e、\u003ccode\u003eMain\u003c/code\u003e和\u003ccode\u003eJoyScript\u003c/code\u003e是页面必须的，在自定义的\u003ccode\u003eDocument\u003c/code\u003e类中，不要删除它们和更改顺序。\n但它们支持一些自定义的属性，例如：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u0026lt;\u003cspan class=\"hljs-title class_\"\u003eHtml\u003c/span\u003e lang=\u003cspan class=\"hljs-string\"\u003e\u0026quot;en\u0026quot;\u003c/span\u003e\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这里的\u003ccode\u003e\u0026lt;Head /\u0026gt;\u003c/code\u003e不同于\u003ccode\u003e@symph/joy/react\u003c/code\u003e中的\u003ccode\u003eHead\u003c/code\u003e组件，这里的\u003ccode\u003e\u0026lt;Head /\u0026gt;\u003c/code\u003e用于定义在所有页面中共有的\u003ccode\u003e\u0026lt;head\u0026gt;\u003c/code\u003e元素，而其它的，例如\u003ccode\u003e\u0026lt;title\u0026gt;\u003c/code\u003e标签，建议在页面组件中使用\u003ccode\u003e@symph/joy/react\u003c/code\u003e中的\u003ccode\u003eHead\u003c/code\u003e组件来定义。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003egetInitialProps\u003c/code\u003e方法返回\u003ccode\u003eDocument\u003c/code\u003e组件的初始 props，参数\u003ccode\u003ectx: DocumentContext\u003c/code\u003e具有以下属性：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003epathname\u003c/code\u003e：\u003ccode\u003estring\u003c/code\u003e，当前渲染的页面路径。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003equery\u003c/code\u003e： \u003ccode\u003eobject\u003c/code\u003e， url 中的请求参数被解析后的对象。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ereq\u003c/code\u003e：\u003ca href=\"https://nodejs.org/api/http.html#http_class_http_incomingmessage\"\u003e\u003ccode\u003eIncomingMessage\u003c/code\u003e\u003c/a\u003e, 触发当前渲染的请求对象。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eres\u003c/code\u003e：\u003ca href=\"https://nodejs.org/api/http.html#http_class_http_serverresponse\"\u003e\u003ccode\u003eServerResponse\u003c/code\u003e\u003c/a\u003e, 触发当前渲染的请求的响应对象。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eerr\u003c/code\u003e ：Error, 在渲染阶段出现的异常。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erenderPage\u003c/code\u003e: \u003ccode\u003efunctin\u003c/code\u003e 将\u003ccode\u003eApp\u003c/code\u003e渲染为 html 字符串，返回值\u003ccode\u003e{html, head}\u003c/code\u003e在服务端渲染时。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"注意事项\"\u003e注意事项\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eDocument\u003c/code\u003e只在服务端被渲染，事件处理并不会触发执行，例如\u003ccode\u003eonClick\u003c/code\u003e事件。同理 React 的部分生命周期也不会执行，例如\u003ccode\u003eonComponentDidMount\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e在\u003ccode\u003e\u0026lt;Main/\u0026gt;\u003c/code\u003e之外的 React 组件并不会被浏览器初始化，所以不要在这里添加任何业务逻辑。如果需要给整个应用添加统一的组件，可以在根布局组件中添加，或者\u003ccode\u003eApp\u003c/code\u003e中添加。\u003c/li\u003e\n\u003c/ul\u003e\n"}]},{"title":"基础使用","path":"/docs/basic","children":[{"title":"快速开始","path":"/docs/getting-started","hasMenu":false,"htmlContent":"\u003ch1 id=\"快速开始\"\u003e快速开始\u003c/h1\u003e\n\u003cp\u003eJoy 支持 React、Node 或者前后端混合应用开发，这里以一个简单的 React 应用为例，介绍如何快速开始开发。\u003c/p\u003e\n\u003ch2 id=\"环境准备\"\u003e环境准备\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003enode 建议 12 或以上版本，推荐使用 nvm 来管理 node 版本。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e推荐使用 yarn 管理依赖，国内使用 \u003ca href=\"https://npmmirror.com/\"\u003e阿里 npm 源\u003c/a\u003e registry: \u003ca href=\"https://registry.npm.taobao.org\"\u003ehttps://registry.npm.taobao.org\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-shell\"\u003e\u003cspan class=\"hljs-meta\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003e安装 yarn\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e$ \u003c/span\u003e\u003cspan class=\"language-bash\"\u003enpm i yarn -g\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003e手动设置`registry`地址为国内源\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e$ \u003c/span\u003e\u003cspan class=\"language-bash\"\u003eyarn config \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e registry https://registry.npm.taobao.org\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003e查看源\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e$ \u003c/span\u003e\u003cspan class=\"language-bash\"\u003eyarn config get registry\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e\n# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003e或者使用 tyarn\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e$ \u003c/span\u003e\u003cspan class=\"language-bash\"\u003enpm i yarn tyarn -g\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003e后面文档里的 yarn 换成 tyarn\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e$ \u003c/span\u003e\u003cspan class=\"language-bash\"\u003etyarn -v\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"创建目录\"\u003e创建目录\u003c/h2\u003e\n\u003cp\u003e创建应用根目录\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-shell\"\u003e\u003cspan class=\"hljs-meta\"\u003e$ \u003c/span\u003e\u003cspan class=\"language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003emkdir\u003c/span\u003e myapp \u0026amp;\u0026amp; \u003cspan class=\"hljs-built_in\"\u003ecd\u003c/span\u003e myapp\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e创建应用内目录和文件，目录结构如下：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-string\"\u003emyapp\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003esrc\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 源代码目录\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003epages\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 约定React路由目录\u003c/span\u003e\n      \u003cspan class=\"hljs-string\"\u003eindex.tsx\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 第一个页面\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003epackage.json\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e在 package.json 内声明应用名和依赖：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-json\"\u003e\u003cspan class=\"hljs-punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;myapp\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;version\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;v1.0.0\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;scripts\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;dev\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;joy dev\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;export\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;joy build\u0026amp;\u0026amp;joy export\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;dependencies\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;^17.0.1\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;react-dom\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;^17.0.1\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;@symph/joy\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;^2.0.0\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"hljs-punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e创建第一个路由页面\u003ccode\u003eindex.tsx\u003c/code\u003e, Joy 同时支持 ES6 和 Typescript 语法，如果使用 ES6，创建 JS 文件\u003ccode\u003eindex.jsx\u003c/code\u003e，添加页面展现内容:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-comment\"\u003e// src/pages/index.tsx\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eReactController\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eBaseReactController\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/react\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-meta\"\u003e@ReactController\u003c/span\u003e()\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eIndex\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title class_ inherited__\"\u003eBaseReactController\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_\"\u003erenderView\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003eHello Joy!\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e;\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"安装依赖\"\u003e安装依赖\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-shell\"\u003e\u003cspan class=\"hljs-meta\"\u003e$ \u003c/span\u003e\u003cspan class=\"language-bash\"\u003eyarn install\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"启动开发服务器\"\u003e启动开发服务器\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-shell\"\u003e\u003cspan class=\"hljs-meta\"\u003e$ \u003c/span\u003e\u003cspan class=\"language-bash\"\u003eyarn dev\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e当命令行输出\u003ccode\u003eready - started server on http://localhost:3000\u003c/code\u003e时，开发服务器启动成功，打开浏览器输入地址 \u003ccode\u003ehttp://localhost:3000\u003c/code\u003e，即可看到我们的第一个页面\u003ccode\u003eHello Joy!\u003c/code\u003e。\n若此时修改页面内容\u003ccode\u003eHello Joy!\u003c/code\u003e为\u003ccode\u003eHello MyApp\u003c/code\u003e，然后保存文件，浏览器界面将自动更新为新内容。\u003c/p\u003e\n\u003ch2 id=\"部署发布\"\u003e部署发布\u003c/h2\u003e\n\u003ch3 id=\"构建\"\u003e构建\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-shell\"\u003e\u003cspan class=\"hljs-meta\"\u003e$ \u003c/span\u003e\u003cspan class=\"language-bash\"\u003eyarn \u003cspan class=\"hljs-built_in\"\u003eexport\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e构建产物默认生成到 ./out 下，目录结构类似于：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-string\"\u003e./out\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003eindex.html\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e404.\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003ehtml\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003e_joy/\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 包含js、css、json等\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"本地验证\"\u003e本地验证\u003c/h3\u003e\n\u003cp\u003e使用\u003ccode\u003ehttp-server\u003c/code\u003e启动本地静态文件服务器\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-shell\"\u003e\u003cspan class=\"hljs-meta\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003e安装 http-server\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e$ \u003c/span\u003e\u003cspan class=\"language-bash\"\u003enpm i -g http-server\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e\n# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003e启动服务器\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e$ \u003c/span\u003e\u003cspan class=\"language-bash\"\u003ehttp-server ./out\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在浏览器上打开地址：\u003ca href=\"http://127.0.0.1:8080\"\u003ehttp://127.0.0.1:8080\u003c/a\u003e, 正常情况下应该是和\u003ccode\u003eyarn dev\u003c/code\u003e开发运行时是一致的。\u003c/p\u003e\n\u003ch3 id=\"部署\"\u003e部署\u003c/h3\u003e\n\u003cp\u003e本地验证完成后，将\u003ccode\u003eout\u003c/code\u003e目录部署到服务器上即可。\u003c/p\u003e\n"},{"title":"配置","path":"/docs/basic/config","children":[{"title":"配置","path":"/docs/basic/config-manager","hasMenu":false,"htmlContent":"\u003ch1 id=\"配置\"\u003e配置\u003c/h1\u003e\n\u003cp\u003eJoy 遵循约定大于配置原则，参考最佳实践约定默认配置，0 配置也可启动应用，即新应用无需配置文件也可立即运行和发布。\u003c/p\u003e\n\u003ch2 id=\"配置文件\"\u003e配置文件\u003c/h2\u003e\n\u003cp\u003eJoy 在\u003ccode\u003ejoy.config.ts\u003c/code\u003e或者\u003ccode\u003econfig/config.ts\u003c/code\u003e中配置项目，支持 ts、js、json、es6 文件格式。例如：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// joy.config.ts\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e {\n  \u003cspan class=\"hljs-attr\"\u003ebasePath\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003eapiPrefix\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;/api\u0026quot;\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003essr\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e如果项目的配置不复杂，推荐在 \u003ccode\u003ejoy.config.ts\u003c/code\u003e 中写配置; 如果项目的配置比较复杂，可以将配置写在 config/config.ts 中，并把配置的一部分拆分出去，加载配置时会自动合并到主配置中，例如路由配置可以拆分成单独的 routes.ts：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// config/routes.ts\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e [{ \u003cspan class=\"hljs-attr\"\u003eexact\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ecomponent\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;index\u0026quot;\u003c/span\u003e }];\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e等同于：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// joy.config.ts\u003c/span\u003e\n{\n  \u003cspan class=\"hljs-attr\"\u003eapiPrefix\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;/api\u0026quot;\u003c/span\u003e;\n  \u003cspan class=\"hljs-attr\"\u003eroutes\u003c/span\u003e: [{ \u003cspan class=\"hljs-attr\"\u003eexact\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ecomponent\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;index\u0026quot;\u003c/span\u003e }];\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"多环境配置\"\u003e多环境配置\u003c/h2\u003e\n\u003cp\u003e可以通过环境变量\u003ccode\u003eNODE_ENV\u003c/code\u003e或者\u003ccode\u003eJOY_ENV\u003c/code\u003e来区分不同环境配置，\u003ccode\u003eJOY_ENV\u003c/code\u003e的优先级更高。各环境配置文件，统一放在\u003ccode\u003e/config\u003c/code\u003e目录中，例如：\u003ccode\u003e/config/config.beta.ts\u003c/code\u003e、\u003ccode\u003e/config/config.production.ts\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e各配置的加载顺序：\u003ccode\u003e.env\u003c/code\u003e ➡ \u003ccode\u003ejoy.config.ts\u003c/code\u003e ➡ \u003ccode\u003econfig/config.ts\u003c/code\u003e ➡ \u003ccode\u003econfig/config.production.ts\u003c/code\u003e ， 后加载的配置会覆盖之前的配置。\u003c/p\u003e\n\u003ch2 id=\"本地临时配置\"\u003e本地临时配置\u003c/h2\u003e\n\u003cp\u003e可以新建 \u003ccode\u003econfig/config.local.ts\u003c/code\u003e文件，例如该配置文件存在，则加载顺序为：\n\u003ccode\u003e.env\u003c/code\u003e ➡ \u003ccode\u003ejoy.config.ts\u003c/code\u003e ➡ \u003ccode\u003econfig/config.ts\u003c/code\u003e ➡ \u003ccode\u003econfig/config.development.ts\u003c/code\u003e ➡ \u003ccode\u003econfig/config.local.ts\u003c/code\u003e 。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e注意：\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e该配置优先级最高，在最后加载该配置文件，且会覆盖之前读取的配置。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003econfig.local.ts\u003c/code\u003e 是本地开发调试的临时配置，请将其添加到 \u003ccode\u003e.gitignore\u003c/code\u003e，\u003cstrong\u003e务必不要提交到 git 仓库中\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"环境变量配置\"\u003e环境变量配置\u003c/h2\u003e\n\u003ch3 id=\"执行命令时添加环境变量\"\u003e执行命令时添加环境变量\u003c/h3\u003e\n\u003cp\u003e例如：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-comment\"\u003e# OS X、 Linux\u003c/span\u003e\n$ port=3000 joy dev\n\n\u003cspan class=\"hljs-comment\"\u003e# Windows\u003c/span\u003e\n$ \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e port=3000\u0026amp;\u0026amp;joy dev\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e如果要同时考虑 OS X 和 Windows，可借助三方工具 cross-env。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ yarn add cross-env --dev\n$ cross-env port=3000 umi dev\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"env-配置文件\"\u003e.env 配置文件\u003c/h3\u003e\n\u003cp\u003eJoy 约定根目录下的\u003ccode\u003e.env\u003c/code\u003e为环境变量配置文件，该配置文件将在初始化配置时加载，其配置的值于 \u003ca href=\"#%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%97%B6%E6%B7%BB%E5%8A%A0%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F\"\u003e执行命令时添加环境变量\u003c/a\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// .env\u003c/span\u003e\n\nport = \u003cspan class=\"hljs-number\"\u003e3000\u003c/span\u003e;\nhostname = \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"应用内获取配置\"\u003e应用内获取配置\u003c/h2\u003e\n\u003ch3 id=\"通过-configservice-服务获取\"\u003e通过 ConfigService 服务获取\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e@symph/config\u003c/code\u003e提供 \u003ccode\u003eConfigService\u003c/code\u003e服务类，Joy 已内置该服务，通过其提供的\u003ccode\u003eget\u0026lt;T = any\u0026gt;(configPath?:string, defaultValue?: T): T | undefined\u003c/code\u003e方法获取配置值，方法参数：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003econfigPath: 配置键值，支持 object path，获取配置值对象的内部值。\u003c/li\u003e\n\u003cli\u003edefaultValue: 默认值，如果配置不存在，则返回默认值。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e例如有以下配置内容：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// joy.config.ts\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e {\n  \u003cspan class=\"hljs-attr\"\u003edatabase\u003c/span\u003e: {\n    \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;mysql\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003ehost\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003eport\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e,\n  },\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在服务类中获取以上配置值：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eConfigService\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/config\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/core\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eValue\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/config\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-meta\"\u003e@Component\u003c/span\u003e()\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHelloService\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e configService: ConfigService\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment\"\u003e// 通过 configKey 获取 配置\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e database = configService.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;database\u0026quot;\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-comment\"\u003e// 如果配置值是一个对象，可以通过object path，获取获取对象内部属性的值\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e host = configService.\u003cspan class=\"hljs-property\"\u003eget\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\u0026gt;(\u003cspan class=\"hljs-string\"\u003e\u0026quot;database.host\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e);\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"value-装饰器方式获取\"\u003e@Value 装饰器方式获取\u003c/h3\u003e\n\u003cp\u003e在组件的属性上，通过\u003ccode\u003e@Value(options)\u003c/code\u003e装饰器申明需要自动注入配置，注入的属性键值默认为组件的属性名称，例如：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/core\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eValue\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/config\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-meta\"\u003e@Component\u003c/span\u003e()\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHelloService\u003c/span\u003e {\n  \u003cspan class=\"hljs-comment\"\u003e// 读取joy.config.ts中配置的msg的值。\u003c/span\u003e\n  \u003cspan class=\"hljs-meta\"\u003e@Value\u003c/span\u003e()\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003emsg\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e@Value(options)\u003c/code\u003e 定制参数列表：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003econfigKey\u003c/strong\u003e 类型\u003ccode\u003estring\u003c/code\u003e，默认等于被装饰的属性名称，指定注入是取的配置文件中的键值，由此属性名称和配置文件中的键值可以不相等。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eschema\u003c/strong\u003e 类型\u003ccode\u003ejson-schema\u003c/code\u003e，自定义 \u003ca href=\"https://json-schema.org/learn/getting-started-step-by-step\"\u003ejson-schema\u003c/a\u003e 定义属性规则，不推荐直接使用该属性，大部分情况下可使用\u003ccode\u003e@tsed/schema\u003c/code\u003e库提供的装饰器来申明校验规则，例如\u003ccode\u003e@Max(3)\u003c/code\u003e申明该配置的值不能大于 4，否则运行是抛出异常。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003etransform\u003c/strong\u003e 类型\u003ccode\u003e(configValue: any) =\u0026gt; any\u003c/code\u003e, 注入值时被调用，入参为配置文件中的值，返回值为转换后的值，然后将转化后的值设置到属性上。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003e@Value()\u003c/code\u003e声明的属性，也等于声明了一个配置项及其类型和验证规则，需要避免在不同地方声明相同的配置但又不兼容的类型，这种情况下，我们可以将声明移动到一个独立的配置类中，其它地方如果需要使用该配置，应该依赖和使用该类。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"校验配置值\"\u003e校验配置值\u003c/h4\u003e\n\u003cp\u003e使用\u003ccode\u003e@tsed/schema\u003c/code\u003e库提供的装饰器来申明校验规则。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/core\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eMax\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eMaxLength\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eRequired\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@tsed/schema\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eValue\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/config\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-meta\"\u003e@Component\u003c/span\u003e()\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBasicConfig\u003c/span\u003e {\n  \u003cspan class=\"hljs-comment\"\u003e// 配置类型为number，且不能大于4，否则运行时抛出异常。\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// 如果未配置，默认为 2\u003c/span\u003e\n  \u003cspan class=\"hljs-meta\"\u003e@Value\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003edefault\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e })\n  \u003cspan class=\"hljs-meta\"\u003e@Max\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eworkers\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e;\n\n  \u003cspan class=\"hljs-comment\"\u003e// 必须配置，且长度不能大于64.\u003c/span\u003e\n  \u003cspan class=\"hljs-meta\"\u003e@Value\u003c/span\u003e()\n  \u003cspan class=\"hljs-meta\"\u003e@MaxLength\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e)\n  \u003cspan class=\"hljs-meta\"\u003e@Required\u003c/span\u003e()\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003emsg\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n\n  \u003cspan class=\"hljs-comment\"\u003e// 配置是一个负责对象数组，类型和验证规则声明在对象的类上。\u003c/span\u003e\n  \u003cspan class=\"hljs-meta\"\u003e@Value\u003c/span\u003e()\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eroutes\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eRoute\u003c/span\u003e[];\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRoute\u003c/span\u003e {\n  \u003cspan class=\"hljs-meta\"\u003e@Required\u003c/span\u003e()\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eextract\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003eboolean\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n"},{"title":"JOY 配置","path":"/docs/basic/joy-config","hasMenu":false,"htmlContent":"\u003ch1 id=\"joy-配置\"\u003eJOY 配置\u003c/h1\u003e\n\u003ch2 id=\"basepath\"\u003ebasePath\u003c/h2\u003e\n\u003cp\u003e类型：\u003ccode\u003estring\u003c/code\u003e 默认值：\u003ccode\u003e\u0026quot;\u0026quot;\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e发布 Joy 应用到子路径下时，使用\u003ccode\u003ebasePath\u003c/code\u003e设置子路径名称。 例如我们开发了一个文档应用，现将它发布到\u003ccode\u003e/docs\u003c/code\u003e子路径下，例如\u003ccode\u003ewww.mydomian.com/docs\u003c/code\u003e。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// config/config.production.ts\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// 只配置 production 环境\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e {\n  \u003cspan class=\"hljs-attr\"\u003ebasePath\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;/docs\u0026quot;\u003c/span\u003e,\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e注意：该配置值在构建编译时设置，会打包到客户端的运行包中，如果修改该值，需要重新编译。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"assetprefix\"\u003eassetPrefix\u003c/h2\u003e\n\u003cp\u003e类型：string，默认:\u003ccode\u003e\u0026quot;\u0026quot;\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e在浏览器上运行时，加载应用资源的路径前缀。一般是在生产环境，将打包好的静态资源部署到不同的服务器（CDN，静态文件服务器）上时配置该值，而开发调试环境无需配置。 例如图片默认路径是\u003ccode\u003e${basePath}/static/logo.png\u003c/code\u003e，假如我们将资源部署到 CDN 上，图片的加载路径变为 CDN 的地址\u003ccode\u003ehttps://cdn.mydomain.com/myapp/static/logo.png\u003c/code\u003e ,此时我们更改\u003ccode\u003eassetPrefix\u003c/code\u003e为 CDN 的地址：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// config/config.production.ts\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e {\n  \u003cspan class=\"hljs-attr\"\u003eassetPrefix\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;https://cdn.mydomain.com/myapp\u0026quot;\u003c/span\u003e,\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"distdir\"\u003edistDir\u003c/h2\u003e\n\u003cp\u003e类型：\u003ccode\u003estring\u003c/code\u003e，默认: \u003ccode\u003e\u0026quot;.joy\u0026quot;\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e编译阶段输出的临时目录，你也可以设置自定义的目录名称。\u003c/p\u003e\n"}]},{"title":"应用目录","path":"/docs/dir-tree","hasMenu":false,"htmlContent":"\u003ch1 id=\"应用目录\"\u003e应用目录\u003c/h1\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e    \u003cspan class=\"hljs-string\"\u003emyapp\u003c/span\u003e\n        \u003cspan class=\"hljs-string\"\u003esrc\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 源代码目录\u003c/span\u003e\n            \u003cspan class=\"hljs-string\"\u003eclient\u003c/span\u003e  \u003cspan class=\"hljs-string\"\u003e--客户端代码\u003c/span\u003e\n                \u003cspan class=\"hljs-string\"\u003epages\u003c/span\u003e    \u003cspan class=\"hljs-comment\"\u003e# 约定React路由目录\u003c/span\u003e\n                \u003cspan class=\"hljs-string\"\u003emodels\u003c/span\u003e    \u003cspan class=\"hljs-comment\"\u003e# ReactModel目录\u003c/span\u003e\n                \u003cspan class=\"hljs-string\"\u003ecomponents\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# React组件\u003c/span\u003e\n            \u003cspan class=\"hljs-string\"\u003eserver\u003c/span\u003e  \u003cspan class=\"hljs-string\"\u003e--服务端代码\u003c/span\u003e\n                \u003cspan class=\"hljs-string\"\u003econtrollers\u003c/span\u003e\n                \u003cspan class=\"hljs-string\"\u003eservices\u003c/span\u003e\n        \u003cspan class=\"hljs-string\"\u003econfig\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 配置目录\u003c/span\u003e\n            \u003cspan class=\"hljs-string\"\u003econfig.ts\u003c/span\u003e\n        \u003cspan class=\"hljs-string\"\u003epublic\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# 静态公共目录\u003c/span\u003e\n            \u003cspan class=\"hljs-string\"\u003elogo.png\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n"},{"title":"CSS 样式","path":"/docs/style-css","hasMenu":false,"htmlContent":"\u003ch1 id=\"css-样式\"\u003eCSS 样式\u003c/h1\u003e\n\u003ch2 id=\"应用全局样式\"\u003e应用全局样式\u003c/h2\u003e\n\u003cp\u003eJoy 中约定在 \u003ccode\u003esrc/global.css\u003c/code\u003e（或\u003ccode\u003eglobal.less\u003c/code\u003e \u003ccode\u003eglobal.sass\u003c/code\u003e ）中定义全局样式，应用启动时会自动加载该样式。\u003c/p\u003e\n\u003cp\u003e比如我们给应用统一设置全局样式，或者覆盖组件样式，新建文件 \u003ccode\u003esrc/global.css\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-css\"\u003e\u003cspan class=\"hljs-selector-tag\"\u003ebody\u003c/span\u003e {\n  \u003cspan class=\"hljs-attribute\"\u003efont-family\u003c/span\u003e: BlinkMacSystemFont, PingFang SC, Microsoft YaHei, sans-serif;\n  \u003cspan class=\"hljs-attribute\"\u003efont-size\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e14px\u003c/span\u003e;\n  \u003cspan class=\"hljs-attribute\"\u003epadding\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e20px\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20px\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e60px\u003c/span\u003e;\n}\n\n\u003cspan class=\"hljs-selector-class\"\u003e.addButton\u003c/span\u003e {\n  \u003cspan class=\"hljs-attribute\"\u003ewidth\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e60px\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"css-模块导入\"\u003eCSS 模块导入\u003c/h2\u003e\n\u003cp\u003eJoy 会对导入的 CSS 文件自动识别是否使用 CSS Modules 导入.\u003c/p\u003e\n\u003ch3 id=\"css-modules-导入\"\u003eCSS Modules 导入\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/css-modules/css-modules\"\u003eCSS Modules\u003c/a\u003e 会将 css 文件内的 class 名称生成唯一的标识，从而避免不同 css 模块类相同 class 名称的冲突。 通常使用 CSS Modules 来定义组件样式，而不用担心和组件间以及全局样式的冲突。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// CSS Modules\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e styles \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;./foo.css\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eButton\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{styles.btnAdd}\u003c/span\u003e\u0026gt;\u003c/span\u003eAdd\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在 CSS Modules 中，也可以通过\u003ccode\u003e:global { }\u003c/code\u003e包裹方式，临时插入全局类样式，被包裹中的代码中定义的 CSS 类名，将不会被 CSS Modules 处理，直接输出到页面。\n例如我们自定义 header 中的菜单组件样式：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-less\"\u003e\u003cspan class=\"hljs-comment\"\u003e// main-layout.less\u003c/span\u003e\n\u003cspan class=\"hljs-selector-class\"\u003e.appHeader\u003c/span\u003e {\n  \u003cspan class=\"hljs-attribute\"\u003eheight\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e64px\u003c/span\u003e;\n\n  :\u003cspan class=\"hljs-selector-tag\"\u003eglobal\u003c/span\u003e {\n    \u003cspan class=\"hljs-selector-class\"\u003e.ant-menu\u003c/span\u003e {\n      \u003cspan class=\"hljs-comment\"\u003e// ant-menu 是 antd \u0026lt;Menu /\u0026gt; 组件中的常量类名。\u003c/span\u003e\n      \u003cspan class=\"hljs-attribute\"\u003eborder\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e;\n    }\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"全局样式导入\"\u003e全局样式导入\u003c/h3\u003e\n\u003cp\u003e非 CSS Modules 方式导入，css 文件内定义的类样式为全局样式，将会控制页面中所有满足条件的 DOM 元素。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 非 CSS Modules\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;./foo.css\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eButton\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;btnAdd\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003eNew\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e;\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// 非 CSS Modules, bar.css内定义的样式为全局样式，将会控制页面中所有满足条件的DOM元素。\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;./bar.css\u0026quot;\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"使用-less\"\u003e使用 LESS\u003c/h2\u003e\n\u003cp\u003eJoy 原生支持 Less，使用 \u003ccode\u003e.less\u003c/code\u003e 后缀名定义 Less 文件。在使用 Less 之前，需要先安装 \u003ca href=\"https://github.com/less/less.js\"\u003eless\u003c/a\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003enpm install less\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"自定义-less-配置\"\u003e自定义 LESS 配置\u003c/h3\u003e\n\u003cp\u003e在 \u003ccode\u003ejoy.config.js\u003c/code\u003e 的 \u003ccode\u003elessOptions\u003c/code\u003e 字段中定义 Less 的自定义配置, 具体可配置项参考 \u003ca href=\"https://webpack.js.org/loaders/less-loader/\"\u003eless-loader\u003c/a\u003e 的配置。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e path = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;path\u0026quot;\u003c/span\u003e);\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eexports\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003elessOptions\u003c/span\u003e: {\n    \u003cspan class=\"hljs-attr\"\u003estrictMath\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n  },\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"使用-sass\"\u003e使用 Sass\u003c/h2\u003e\n\u003cp\u003eJoy 原生支持 Sass，使用 \u003ccode\u003e.scss\u003c/code\u003e 或 \u003ccode\u003e.sass\u003c/code\u003e 后缀名定义 Sass 文件，在使用 Sass 之前，需要先安装 \u003ca href=\"https://github.com/sass/sass\"\u003esass\u003c/a\u003e :\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003enpm install sass\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSass 支持 2 种语法格式定义来样式，\u003ccode\u003e.scss\u003c/code\u003e文件使用\u003ca href=\"https://sass-lang.com/documentation/syntax#scss\"\u003eSCSS 语法\u003c/a\u003e ，\u003ccode\u003e.sass\u003c/code\u003e文件使用 \u003ca href=\"https://sass-lang.com/documentation/syntax#the-indented-syntax\"\u003eIndented Syntax (\u0026quot;Sass\u0026quot;)\u003c/a\u003e 语法。\n如果你不确定使用哪种语法，可首先采用\u003ccode\u003e.scss\u003c/code\u003e，它是 CSS 的扩展，可使用 CSS 的全部语法，不需要学习新的 Indented Syntax 缩进语法。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"自定义-sass-配置\"\u003e自定义 Sass 配置\u003c/h3\u003e\n\u003cp\u003e在 \u003ccode\u003ejoy.config.js\u003c/code\u003e 的 \u003ccode\u003esassOptions\u003c/code\u003e 字段中定义 Sass 的自定义配置, 具体可配置项参考 \u003ca href=\"https://webpack.js.org/loaders/sass-loader/\"\u003esass-loader\u003c/a\u003e 的配置。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e path = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;path\u0026quot;\u003c/span\u003e);\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eexports\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003esassOptions\u003c/span\u003e: {\n    \u003cspan class=\"hljs-attr\"\u003eadditionalData\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;$env: \u0026quot;\u003c/span\u003e + process.\u003cspan class=\"hljs-property\"\u003eenv\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eNODE_ENV\u003c/span\u003e + \u003cspan class=\"hljs-string\"\u003e\u0026quot;;\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003eindentWidth\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003eincludePaths\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026quot;/absolute/path/a\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;/absolute/path/b\u0026quot;\u003c/span\u003e],\n  },\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"sass-变量\"\u003eSass 变量\u003c/h3\u003e\n\u003cp\u003eJoy 支持 Sass 变量从 CSS Module 文件中导出。比如导出\u003ccode\u003eprimaryColor\u003c/code\u003e变量：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scss\"\u003e\u003cspan class=\"hljs-comment\"\u003e/* index-scss-variables.scss */\u003c/span\u003e\n\u003cspan class=\"hljs-variable\"\u003e$primary-color\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e#ff0000\u003c/span\u003e;\n\n:export {\n  primaryColor: \u003cspan class=\"hljs-variable\"\u003e$primary-color\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-comment\"\u003e// index-scss-variables.js\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e variables \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;../index-scss-variables.scss\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eMyApp\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e{ Component, pageProps }\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{{\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ecolor:\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003evariables.primaryColor\u003c/span\u003e }}\u0026gt;\u003c/span\u003eHello\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"todo\"\u003etodo\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e自定义 PostCss \u003ca href=\"https://nextjs.org/docs/advanced-features/customizing-postcss-config\"\u003ehttps://nextjs.org/docs/advanced-features/customizing-postcss-config\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n"}]},{"title":"start","path":"/docs/start","children":[{"title":"Hello Joy","path":"/docs/introduce","hasMenu":false,"htmlContent":"\u003ch1 id=\"hello-joy\"\u003eHello Joy\u003c/h1\u003e\n\u003chr\u003e\n\u003cp\u003efdfdsfas\u003c/p\u003e\n"}]}],"titleTrees":[{"type":"heading","raw":"## 配置文件\n\n","depth":2,"text":"配置文件","tokens":[{"type":"text","raw":"配置文件","text":"配置文件"}],"id":"#配置文件"},{"type":"heading","raw":"## 多环境配置\n\n","depth":2,"text":"多环境配置","tokens":[{"type":"text","raw":"多环境配置","text":"多环境配置"}],"id":"#多环境配置"},{"type":"heading","raw":"## 本地临时配置\n\n","depth":2,"text":"本地临时配置","tokens":[{"type":"text","raw":"本地临时配置","text":"本地临时配置"}],"id":"#本地临时配置"},{"type":"heading","raw":"## 环境变量配置\n\n","depth":2,"text":"环境变量配置","tokens":[{"type":"text","raw":"环境变量配置","text":"环境变量配置"}],"id":"#环境变量配置","children":[{"type":"heading","raw":"### 执行命令时添加环境变量\n\n","depth":3,"text":"执行命令时添加环境变量","tokens":[{"type":"text","raw":"执行命令时添加环境变量","text":"执行命令时添加环境变量"}],"id":"#执行命令时添加环境变量"},{"type":"heading","raw":"### .env 配置文件\n\n","depth":3,"text":".env 配置文件","tokens":[{"type":"text","raw":".env 配置文件","text":".env 配置文件"}],"id":"#.env-配置文件"}]},{"type":"heading","raw":"## 应用内获取配置\n\n","depth":2,"text":"应用内获取配置","tokens":[{"type":"text","raw":"应用内获取配置","text":"应用内获取配置"}],"id":"#应用内获取配置","children":[{"type":"heading","raw":"### 通过 ConfigService 服务获取\n\n","depth":3,"text":"通过 ConfigService 服务获取","tokens":[{"type":"text","raw":"通过 ConfigService 服务获取","text":"通过 ConfigService 服务获取"}],"id":"#通过-configservice-服务获取"},{"type":"heading","raw":"### @Value 装饰器方式获取\n\n","depth":3,"text":"@Value 装饰器方式获取","tokens":[{"type":"text","raw":"@Value 装饰器方式获取","text":"@Value 装饰器方式获取"}],"id":"#@value-装饰器方式获取"}]}],"currentDoc":{"title":"配置","path":"/docs/basic/config-manager","file":"docs/basic/config/config-manager.md","hasMenu":false,"htmlContent":"\u003ch1 id=\"配置\"\u003e配置\u003c/h1\u003e\n\u003cp\u003eJoy 遵循约定大于配置原则，参考最佳实践约定默认配置，0 配置也可启动应用，即新应用无需配置文件也可立即运行和发布。\u003c/p\u003e\n\u003ch2 id=\"配置文件\"\u003e配置文件\u003c/h2\u003e\n\u003cp\u003eJoy 在\u003ccode\u003ejoy.config.ts\u003c/code\u003e或者\u003ccode\u003econfig/config.ts\u003c/code\u003e中配置项目，支持 ts、js、json、es6 文件格式。例如：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// joy.config.ts\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e {\n  \u003cspan class=\"hljs-attr\"\u003ebasePath\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003eapiPrefix\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;/api\u0026quot;\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003essr\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e如果项目的配置不复杂，推荐在 \u003ccode\u003ejoy.config.ts\u003c/code\u003e 中写配置; 如果项目的配置比较复杂，可以将配置写在 config/config.ts 中，并把配置的一部分拆分出去，加载配置时会自动合并到主配置中，例如路由配置可以拆分成单独的 routes.ts：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// config/routes.ts\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e [{ \u003cspan class=\"hljs-attr\"\u003eexact\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ecomponent\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;index\u0026quot;\u003c/span\u003e }];\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e等同于：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// joy.config.ts\u003c/span\u003e\n{\n  \u003cspan class=\"hljs-attr\"\u003eapiPrefix\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;/api\u0026quot;\u003c/span\u003e;\n  \u003cspan class=\"hljs-attr\"\u003eroutes\u003c/span\u003e: [{ \u003cspan class=\"hljs-attr\"\u003eexact\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ecomponent\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;index\u0026quot;\u003c/span\u003e }];\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"多环境配置\"\u003e多环境配置\u003c/h2\u003e\n\u003cp\u003e可以通过环境变量\u003ccode\u003eNODE_ENV\u003c/code\u003e或者\u003ccode\u003eJOY_ENV\u003c/code\u003e来区分不同环境配置，\u003ccode\u003eJOY_ENV\u003c/code\u003e的优先级更高。各环境配置文件，统一放在\u003ccode\u003e/config\u003c/code\u003e目录中，例如：\u003ccode\u003e/config/config.beta.ts\u003c/code\u003e、\u003ccode\u003e/config/config.production.ts\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e各配置的加载顺序：\u003ccode\u003e.env\u003c/code\u003e ➡ \u003ccode\u003ejoy.config.ts\u003c/code\u003e ➡ \u003ccode\u003econfig/config.ts\u003c/code\u003e ➡ \u003ccode\u003econfig/config.production.ts\u003c/code\u003e ， 后加载的配置会覆盖之前的配置。\u003c/p\u003e\n\u003ch2 id=\"本地临时配置\"\u003e本地临时配置\u003c/h2\u003e\n\u003cp\u003e可以新建 \u003ccode\u003econfig/config.local.ts\u003c/code\u003e文件，例如该配置文件存在，则加载顺序为：\n\u003ccode\u003e.env\u003c/code\u003e ➡ \u003ccode\u003ejoy.config.ts\u003c/code\u003e ➡ \u003ccode\u003econfig/config.ts\u003c/code\u003e ➡ \u003ccode\u003econfig/config.development.ts\u003c/code\u003e ➡ \u003ccode\u003econfig/config.local.ts\u003c/code\u003e 。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e注意：\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e该配置优先级最高，在最后加载该配置文件，且会覆盖之前读取的配置。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003econfig.local.ts\u003c/code\u003e 是本地开发调试的临时配置，请将其添加到 \u003ccode\u003e.gitignore\u003c/code\u003e，\u003cstrong\u003e务必不要提交到 git 仓库中\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"环境变量配置\"\u003e环境变量配置\u003c/h2\u003e\n\u003ch3 id=\"执行命令时添加环境变量\"\u003e执行命令时添加环境变量\u003c/h3\u003e\n\u003cp\u003e例如：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-comment\"\u003e# OS X、 Linux\u003c/span\u003e\n$ port=3000 joy dev\n\n\u003cspan class=\"hljs-comment\"\u003e# Windows\u003c/span\u003e\n$ \u003cspan class=\"hljs-built_in\"\u003eset\u003c/span\u003e port=3000\u0026amp;\u0026amp;joy dev\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e如果要同时考虑 OS X 和 Windows，可借助三方工具 cross-env。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ yarn add cross-env --dev\n$ cross-env port=3000 umi dev\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"env-配置文件\"\u003e.env 配置文件\u003c/h3\u003e\n\u003cp\u003eJoy 约定根目录下的\u003ccode\u003e.env\u003c/code\u003e为环境变量配置文件，该配置文件将在初始化配置时加载，其配置的值于 \u003ca href=\"#%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%97%B6%E6%B7%BB%E5%8A%A0%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F\"\u003e执行命令时添加环境变量\u003c/a\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// .env\u003c/span\u003e\n\nport = \u003cspan class=\"hljs-number\"\u003e3000\u003c/span\u003e;\nhostname = \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"应用内获取配置\"\u003e应用内获取配置\u003c/h2\u003e\n\u003ch3 id=\"通过-configservice-服务获取\"\u003e通过 ConfigService 服务获取\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e@symph/config\u003c/code\u003e提供 \u003ccode\u003eConfigService\u003c/code\u003e服务类，Joy 已内置该服务，通过其提供的\u003ccode\u003eget\u0026lt;T = any\u0026gt;(configPath?:string, defaultValue?: T): T | undefined\u003c/code\u003e方法获取配置值，方法参数：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003econfigPath: 配置键值，支持 object path，获取配置值对象的内部值。\u003c/li\u003e\n\u003cli\u003edefaultValue: 默认值，如果配置不存在，则返回默认值。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e例如有以下配置内容：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// joy.config.ts\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e {\n  \u003cspan class=\"hljs-attr\"\u003edatabase\u003c/span\u003e: {\n    \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;mysql\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003ehost\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003eport\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e,\n  },\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在服务类中获取以上配置值：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eConfigService\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/config\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/core\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eValue\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/config\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-meta\"\u003e@Component\u003c/span\u003e()\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHelloService\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e configService: ConfigService\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment\"\u003e// 通过 configKey 获取 配置\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e database = configService.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;database\u0026quot;\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-comment\"\u003e// 如果配置值是一个对象，可以通过object path，获取获取对象内部属性的值\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e host = configService.\u003cspan class=\"hljs-property\"\u003eget\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\u0026gt;(\u003cspan class=\"hljs-string\"\u003e\u0026quot;database.host\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e);\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"value-装饰器方式获取\"\u003e@Value 装饰器方式获取\u003c/h3\u003e\n\u003cp\u003e在组件的属性上，通过\u003ccode\u003e@Value(options)\u003c/code\u003e装饰器申明需要自动注入配置，注入的属性键值默认为组件的属性名称，例如：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/core\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eValue\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/config\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-meta\"\u003e@Component\u003c/span\u003e()\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHelloService\u003c/span\u003e {\n  \u003cspan class=\"hljs-comment\"\u003e// 读取joy.config.ts中配置的msg的值。\u003c/span\u003e\n  \u003cspan class=\"hljs-meta\"\u003e@Value\u003c/span\u003e()\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003emsg\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e@Value(options)\u003c/code\u003e 定制参数列表：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003econfigKey\u003c/strong\u003e 类型\u003ccode\u003estring\u003c/code\u003e，默认等于被装饰的属性名称，指定注入是取的配置文件中的键值，由此属性名称和配置文件中的键值可以不相等。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eschema\u003c/strong\u003e 类型\u003ccode\u003ejson-schema\u003c/code\u003e，自定义 \u003ca href=\"https://json-schema.org/learn/getting-started-step-by-step\"\u003ejson-schema\u003c/a\u003e 定义属性规则，不推荐直接使用该属性，大部分情况下可使用\u003ccode\u003e@tsed/schema\u003c/code\u003e库提供的装饰器来申明校验规则，例如\u003ccode\u003e@Max(3)\u003c/code\u003e申明该配置的值不能大于 4，否则运行是抛出异常。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003etransform\u003c/strong\u003e 类型\u003ccode\u003e(configValue: any) =\u0026gt; any\u003c/code\u003e, 注入值时被调用，入参为配置文件中的值，返回值为转换后的值，然后将转化后的值设置到属性上。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003e@Value()\u003c/code\u003e声明的属性，也等于声明了一个配置项及其类型和验证规则，需要避免在不同地方声明相同的配置但又不兼容的类型，这种情况下，我们可以将声明移动到一个独立的配置类中，其它地方如果需要使用该配置，应该依赖和使用该类。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"校验配置值\"\u003e校验配置值\u003c/h4\u003e\n\u003cp\u003e使用\u003ccode\u003e@tsed/schema\u003c/code\u003e库提供的装饰器来申明校验规则。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eComponent\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/core\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eMax\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eMaxLength\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eRequired\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@tsed/schema\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eValue\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@symph/config\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-meta\"\u003e@Component\u003c/span\u003e()\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBasicConfig\u003c/span\u003e {\n  \u003cspan class=\"hljs-comment\"\u003e// 配置类型为number，且不能大于4，否则运行时抛出异常。\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// 如果未配置，默认为 2\u003c/span\u003e\n  \u003cspan class=\"hljs-meta\"\u003e@Value\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003edefault\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e })\n  \u003cspan class=\"hljs-meta\"\u003e@Max\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eworkers\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e;\n\n  \u003cspan class=\"hljs-comment\"\u003e// 必须配置，且长度不能大于64.\u003c/span\u003e\n  \u003cspan class=\"hljs-meta\"\u003e@Value\u003c/span\u003e()\n  \u003cspan class=\"hljs-meta\"\u003e@MaxLength\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e)\n  \u003cspan class=\"hljs-meta\"\u003e@Required\u003c/span\u003e()\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003emsg\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n\n  \u003cspan class=\"hljs-comment\"\u003e// 配置是一个负责对象数组，类型和验证规则声明在对象的类上。\u003c/span\u003e\n  \u003cspan class=\"hljs-meta\"\u003e@Value\u003c/span\u003e()\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eroutes\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eRoute\u003c/span\u003e[];\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRoute\u003c/span\u003e {\n  \u003cspan class=\"hljs-meta\"\u003e@Required\u003c/span\u003e()\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eextract\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003eboolean\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n"},"result":[],"defaultOption":["/docs/advanced-features","/docs/basic","/docs/basic/config","/docs/start"]}},"props":{},"page":"/docs/docs/basic/config-manager","query":{},"buildId":"y8hmQRIqWxbtvHCDLHR2O","joyExport":false,"isFallback":false,"ssr":true,"gip":true}</script><script nomodule="" src="/_joy/static/chunks/polyfills-cba461cdccaea3f1349c.js"></script><script src="/_joy/static/chunks/main-f5ad9e2f6a1848fb96a9.js" async=""></script><script src="/_joy/static/chunks/webpack-373fdeea3ec48be3183e.js" async=""></script><script src="/_joy/static/chunks/framework-91d62d687813a572f876.js" async=""></script><script src="/_joy/static/chunks/commons-b00d9a851efe857c40f3.js" async=""></script><script src="/_joy/static/chunks/pages/_app-90191bb1e1c9998796e2.js" async=""></script><script src="/_joy/static/y8hmQRIqWxbtvHCDLHR2O/_buildManifest.js" async=""></script><script src="/_joy/static/y8hmQRIqWxbtvHCDLHR2O/_ssgManifest.js" async=""></script></body></html>